{"version":3,"sources":["index.js"],"names":["express","require","passport","router","Router","Account","get","req","res","render","title","user","post","findOne","username","body","then","err","message","account","newAccount","register","password","console","log","redirect","authenticate","next","logout","status","send","module","exports"],"mappings":"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","sourcesContent":["var express = require('express');\r\nvar passport = require('passport');\r\nvar router = express.Router();\r\nvar Account = require('../models/account');\r\n\r\nrouter.get('/', function (req, res) {\r\n    res.render('index', { title: 'ship App', user : req.user });\r\n});\r\n\r\nrouter.get('/register', function(req, res) {\r\n    res.render('register', { title: 'ship App Registration'});\r\n});\r\n\r\nrouter.post('/register', function(req, res) {\r\n    Account.findOne({ username : req.body.username }).then((err, user)=> {\r\n        if(err) {\r\n            return res.render('register', { title: 'Registration', message: 'Registration error', account : req.body.username })\r\n        }\r\n        if(user == {} ){\r\n            return res.render('register', { title: 'Registration', message: 'Existing User', account : req.body.username })\r\n        }\r\n        let newAccount = new Account({ username : req.body.username });\r\n        Account.register(newAccount, req.body.password, function(err, user){\r\n            if (err) {\r\n                return res.render('register', { title: 'Registration', message: 'access error', account : req.body.username })\r\n            }\r\n            if(!user){\r\n                return res.render('register',{ title: 'Registration', message: 'access error', account : req.body.username })\r\n            }\r\n            console.log('Sucess, redirect');\r\n            res.redirect('/');\r\n        })\r\n    }\r\n)});\r\n\r\nrouter.get('/login', function(req, res) {\r\n    res.render('login', { title: 'ship App Login', user : req.user });\r\n});\r\n\r\nrouter.post('/login', passport.authenticate('local'), function(req, res) {\r\n    res.redirect('/');\r\n});\r\n\r\nrouter.get('/logout', function(req, res, next) { // use post or delete for better safety\r\n    req.logout( function(err) {\r\n        if (err) { return next(err);}\r\n        res.redirect('/');\r\n    });\r\n});\r\n\r\nrouter.get('/ping', function(req, res){\r\n    res.status(200).send(\"pong!\");\r\n});\r\n\r\nmodule.exports=router;\r\n"],"file":"index.dev.js"}